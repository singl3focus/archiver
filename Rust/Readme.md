# Backend of Archiver project (Rust)

Приложение предоставляет функциональность для сжатия и распаковки файлов в различных форматах с возможностью их шифрования и расшифровки. В нем используются библиотеки flate2, aes, tar, zip_archive и другие для выполнения операций с архивами и криптографией.


# Project summary

## Навигация по документации
- [Общие сведения](#общие-сведения) 
- [Установка](#установка) 
- [Использование](#использование) 
- [Алгоритмы сжатия и форматы файлов](#алгоритмы-сжатия-и-форматы-файлов) 
- [Шифрование и расшифровка](#шифрование-и-расшифровка) 
- [Ошибки и обработка исключений](#ошибки-и-обработка-исключений) 
- [Заключение](#заключение) 


-----

### Общие сведения
Приложение ***antim*** представляет собой инструмент для сжатия и распаковки файлов с поддержкой различных форматов, включая ZIP и TAR, а также с возможностью шифрования и расшифровки данных с использованием алгоритма AES-256 в режиме CTR. Программа поддерживает следующие операции:

- Сжатие данных в архив (ZIP или TAR).
- Распаковка архивов (ZIP или TAR).
- Шифрование и расшифровка архивов с использованием пароля.

-----

### Установка
Для использования данного приложения необходимо иметь установленный Rust и соответствующие библиотеки. Для установки выполните следующие шаги:

1. Скачайте исходный код приложения.
2. Перейдите в директорию с проектом и выполните подходящую команду:

- Build in debug mode: \
```cargo build --bin antim```

- Build in release mode: \
```cargo build --bin antim --release```

- Run app (Dev mode): \
```cargo run```

- Launch the application via a binary file: \
```cargo run```

> После сборки, исполнимая версия приложения будет находиться в директории ```target/release/```.

-----

### Использование
Приложение запускается с помощью командной строки. Пример базового вызова:

```sh
antim <режим> --source <путь_к_исходному_файлу> --destination <путь_к_папке_назначения> [--format <формат>] [--password <пароль>]
```

#### Режимы работы
Программа поддерживает два основных режима работы:

1. **Compress** — сжатие данных.
2. **Decompress** — распаковка данных.

#### Описание параметров командной строки
- ```--source``` (*обязательный*): Путь к исходному файлу или каталогу, который необходимо обработать.
- ```--destination``` (*обязательный*): Путь к каталогу, куда будет сохранен результат работы программы.
- ```--format``` (*необязательный*): Формат архива, в который нужно сжать данные. Для распаковки формат определяется автоматически.
- ``--password`` (*необязательный*): Пароль, используемый для шифрования или расшифровки архива.

-----

### Алгоритмы сжатия и форматы файлов

#### Поддерживаемые форматы:
- **ZIP** — Стандартный формат сжатия данных, используется для сжатия и распаковки файлов.
- **TAR.GZ** — Сжатый формат, представляющий собой комбинацию *TAR* и *GZ*. В свою очередь, *TAR* - это архивный файл без сжатия, *GZ* — файл (архивный или не архивный), который сжали.

#### Описание операций с форматами:
При сжатии данных программа поддерживает два формата: *ZIP* и *TAR*.
При распаковке, программа автоматически определяет формат архива и распаковывает его соответствующими методами:
- **ZIP** — через библиотеку zip_archive.
- **TAR.GZ** — через библиотеку flate2 и tar.

-----

### Шифрование и расшифровка
Программа поддерживает шифрование и расшифровку архивов с использованием AES-256 в режиме CTR. Алгоритм шифрования используется для защиты содержимого архивов, создавая зашифрованную версию архива.

#### Как работает шифрование:
1. Для шифрования архива необходимо передать пароль с помощью параметра ```--password```.
2. Программа дополнительно создает зашифрованную версию архива с расширением ```.enc```.
3. Для шифрования используется алгоритм **AES-256-CTR**.
4. В качестве инициализирующего вектора (IV) используется фиксированное значение.

#### Как работает расшифровка:
1. При расшифровке необходимо предоставить пароль с помощью параметра ```--password```.
2. Если файл зашифрован, программа сначала расшифровывает его, а затем распаковывает в указанный каталог.

#### О режимах шифрования:
- **ECB (Electronic Codebook)**:
Самый простой режим, где каждый блок данных шифруется отдельно. *Недостаток*: одинаковые блоки данных шифруются одинаково, что может привести к утечке информации.

- **CBC (Cipher Block Chaining)**:
Каждый блок данных XOR'ится с предыдущим зашифрованным блоком перед шифрованием. Требует вектора инициализации (IV) для шифрования первого блока. *Преимущество*: одинаковые блоки данных шифруются по-разному.

- **CFB (Cipher Feedback)**:
Работает как потоковый шифр, шифруя данные побитно или поблочно. Использует IV и предыдущий зашифрованный блок для шифрования следующего блока.

- **OFB (Output Feedback)**:
Также работает как потоковый шифр. Использует IV и предыдущий зашифрованный блок для генерации потока ключей, который затем XOR'ится с данными.

- **CTR (Counter)**:
Превращает блочный шифр в потоковый шифр. Использует счетчик, который инкрементируется для каждого блока данных.
*Преимущество*: параллельная обработка блоков данных.

-----

### Ошибки и обработка исключений
Программа использует стандартную обработку ошибок в Rust с использованием типа Result. При возникновении ошибок выводится сообщение, и программа завершает работу с кодом ошибки.

#### Возможные ошибки:
- ```Invalid source path```
- ```Destination path must be directory, not file```
- ```Data format is empty```


#### Пример работы приложения
- Сжатие данных в архив: Чтобы сжать файл в архив ZIP с шифрованием, выполните команду:
```sh
antim --mode Compress --source /path/to/source/file.txt --destination /path/to/destination --format zip --password my_secret_password
```

- Распаковка зашифрованного архива: Чтобы распаковать зашифрованный архив и расшифровать его, выполните команду:
```sh
antim --mode Decompress --source /path/to/source/file.zip.enc --destination /path/to/destination --password my_secret_password
```

-----

### Заключение
>Приложение ***antim*** представляет собой мощный инструмент для сжатия, распаковки и защиты данных с помощью шифрования. Оно поддерживает различные форматы архивов и предлагает простой интерфейс для командной строки.

